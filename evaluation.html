<!DOCTYPE html>
<html lang="en" class="transition-colors">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>EVALOGOTOR - Tasks</title>

<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = { darkMode: 'class' }
</script>

<script src="https://unpkg.com/lucide@latest"></script>

<style>
  .highlight {
    font-weight: bold;
    font-size: 1.25rem;
    color: rgb(57, 220, 57);
  }
  .status-ue { color: #94a3b8; }
</style>
</head>

<body id="body"
  class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-white
         min-h-screen flex flex-col transition-colors">

<!-- ================= NAVBAR ================= -->
<header id="navbar"
  class="fixed top-0 left-0 w-full z-50
         flex items-center justify-between px-6 py-4 shadow-sm
         bg-white dark:bg-gray-800">

  <div class="flex items-center group cursor-pointer">
    <span class="font-bold text-xl text-blue-600 group-hover:text-[rgb(57,220,57)]">EVA</span>
    <span class="highlight group-hover:text-[rgb(57,220,57)]">LOGO</span>
    <span class="font-bold text-xl text-blue-600 group-hover:text-[rgb(57,220,57)]">TOR</span>
  </div>

  <nav class="flex items-center space-x-4">

    <button id="homeBtn"
      class="flex items-center space-x-1 rounded-xl px-3 py-1
             text-gray-500 dark:text-gray-300
             hover:text-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700"
      onclick="location.href='/'">
      <i data-lucide="home" class="w-4 h-4"></i>
      <span id="home">Home</span>
    </button>

    <button id="tasksBtn"
      class="flex items-center space-x-1 rounded-xl px-3 py-1
             text-gray-500 dark:text-gray-300
             hover:text-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700"
      onclick="location.href='tasks'">
      <i data-lucide="pen-tool" class="w-4 h-4"></i>
      <span id="tasks">Tasks</span>
    </button>

    <button id="scoreboardBtn"
      class="flex items-center space-x-1 rounded-xl px-3 py-1
             text-gray-500 dark:text-gray-300
             hover:text-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700"
      onclick="location.href='scoreboard'">
      <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
      <span id="scoreboard">Scoreboard</span>
    </button>

    <!-- Login -->
    <button id="loginBtn"
      class="rounded-xl flex items-center
             bg-white dark:bg-[rgb(17,24,38)]
             text-gray-900 dark:text-white
             hover:bg-gray-100 dark:hover:bg-gray-700
             border border-gray-300 dark:border-gray-600
             px-3 py-1"
      onclick="location.href='login'">
      <i data-lucide="user" class="w-4 h-4 mr-1"></i>
      <span id="login">Login</span>
    </button>

    <!-- Theme toggle -->
    <button id="themeToggle"
      class="rounded-xl flex items-center
             bg-white dark:bg-[rgb(17,24,38)]
             text-gray-900 dark:text-white
             hover:bg-gray-100 dark:hover:bg-gray-700
             border border-gray-300 dark:border-gray-600
             px-3 py-1">
      <i id="themeIcon" data-lucide="moon" class="w-4 h-4 mr-1"></i>
      <span id="themeLabel">Dark</span>
    </button>

    <!-- Language -->
    <div
      class="flex items-center rounded-xl px-2 py-1
             border border-gray-300 dark:border-gray-600
             bg-white dark:bg-[rgb(17,24,38)]">
      <i data-lucide="globe" class="w-4 h-4 mr-1"></i>
      <select id="langSelect"
        class="bg-transparent focus:outline-none
               text-gray-900 dark:text-white">
        <option value="en">EN</option>
        <option value="de">DE</option>
        <option value="it">IT</option>
        <option value="hr">HR</option>
        <option value="fr">FR</option>
        <option value="ru">RU</option>
      </select>
    </div>

  </nav>
</header>

<!-- ================= MAIN ================= -->
<main class="max-w-5xl mx-auto w-full px-6 pt-28 pb-6 flex flex-col gap-4">

  <div id="taskContext"
       class="rounded-2xl p-4 shadow
              bg-gray-100 dark:bg-gray-800
              font-mono text-xl">
    empty
  </div>

  <textarea
    class="h-64 w-full rounded-lg p-3 font-mono text-sm
           bg-gray-100 dark:bg-gray-900
           border border-gray-300 dark:border-gray-700"
    placeholder="Paste your solution code here..."></textarea>

  <div class="flex items-center gap-4">
    <button
      class="px-6 py-2 rounded-xl bg-blue-600 hover:bg-blue-700
             text-white font-semibold" id="evalBtn">
      Evaluate
    </button>
    <span class="status-ue font-semibold" id="evalStatus">Unevaluated</span>
  </div>

</main>

<script>
lucide.createIcons();

/* ===== TRANSLATIONS ===== */
const translations = {
  en: { 
    home:"Home", tasks:"Tasks", scoreboard:"Scoreboard", login:"Login", dark:"Dark", light:"Light", 
    evaluate:"Evaluate", unevaluated:"Unevaluated",
    codePlaceholder: "Paste your solution code here..."
  },
  de: { 
    home:"Home", tasks:"Aufgaben", scoreboard:"Rangliste", login:"Anmelden", dark:"Dunkel", light:"Hell", 
    evaluate:"Auswerten", unevaluated:"Nicht bewertet",
    codePlaceholder: "Lösungscode hier einfügen..."
  },
  it: { 
    home:"Home", tasks:"Compiti", scoreboard:"Classifica", login:"Accedi", dark:"Scuro", light:"Chiaro", 
    evaluate:"Valuta", unevaluated:"Non valutato",
    codePlaceholder: "Incolla qui il codice della soluzione..."
  },
  hr: { 
    home:"Home", tasks:"Zadaci", scoreboard:"Ljestvica", login:"Prijava", dark:"Tamno", light:"Svijetlo", 
    evaluate:"Procijeni", unevaluated:"Neocijenjeno",
    codePlaceholder: "Zalijepite ovdje rješenje..."
  },
  fr: { 
    home:"Home", tasks:"Tâches", scoreboard:"Classement", login:"Connexion", dark:"Sombre", light:"Clair", 
    evaluate:"Évaluer", unevaluated:"Non évalué",
    codePlaceholder: "Collez votre code ici..."
  },
  ru: { 
    home:"Home", tasks:"Задания", scoreboard:"Рейтинг", login:"Войти", dark:"Тёмный", light:"Светлый", 
    evaluate:"Оценить", unevaluated:"Неоценено",
    codePlaceholder: "Вставьте ваш код решения здесь..."
  }
};

/* ===== LANGUAGE ===== */
let lang = localStorage.getItem("lang") || "en";
const langSelect = document.getElementById("langSelect");
langSelect.value = lang;

function applyTranslations() {
  document.getElementById("home").textContent = translations[lang].home;
  document.getElementById("tasks").textContent = translations[lang].tasks;
  document.getElementById("scoreboard").textContent = translations[lang].scoreboard;
  document.getElementById("login").textContent = translations[lang].login;
  document.getElementById("themeLabel").textContent = darkMode ? translations[lang].light : translations[lang].dark;
  document.getElementById("evalBtn").textContent = translations[lang].evaluate;
  document.getElementById("evalStatus").textContent = translations[lang].unevaluated;

  const codeTextarea = document.querySelector("textarea");
  if(codeTextarea) codeTextarea.placeholder = translations[lang].codePlaceholder;
}

langSelect.addEventListener("change", e => {
  lang = e.target.value;
  localStorage.setItem("lang", lang);
  applyTranslations();
  applyTheme();
});

/* ===== THEME ===== */
let darkMode = localStorage.getItem("theme") === "dark";

function updateSelectOptionsColors() {
  const options = document.querySelectorAll('#langSelect option');
  if(darkMode){
    options.forEach(opt => { opt.style.backgroundColor = "rgb(17, 24, 38)"; opt.style.color = "white"; });
  } else {
    options.forEach(opt => { opt.style.backgroundColor = "white"; opt.style.color = "black"; });
  }
}

function applyTheme() {
  document.documentElement.classList.toggle("dark", darkMode);

  const themeLabel = document.getElementById("themeLabel");
  themeLabel.textContent = darkMode ? translations[lang].light : translations[lang].dark;

  // Buttons: login + theme
  [document.getElementById("loginBtn"), document.getElementById("themeToggle")].forEach(btn=>{
    if(darkMode){
      btn.classList.remove("bg-white","text-gray-900","hover:bg-gray-100","hover:text-gray-900");
      btn.classList.add("bg-[rgb(17,24,38)]","text-white","hover:bg-gray-700","hover:text-white");
    } else {
      btn.classList.remove("bg-[rgb(17,24,38)]","text-white","hover:bg-gray-700","hover:text-white");
      btn.classList.add("bg-white","text-gray-900","hover:bg-gray-100","hover:text-gray-900");
    }
  });

  // Language select background + options
  const langParent = langSelect.parentElement;
  if(darkMode){
    langParent.classList.remove("bg-white","border-gray-300");
    langParent.classList.add("bg-[rgb(17,24,38)]","border-gray-600");
    langSelect.classList.remove("text-gray-900");
    langSelect.classList.add("text-white");
  } else {
    langParent.classList.remove("bg-[rgb(17,24,38)]","border-gray-600");
    langParent.classList.add("bg-white","border-gray-300");
    langSelect.classList.remove("text-white");
    langSelect.classList.add("text-gray-900");
  }

  updateSelectOptionsColors();
  lucide.createIcons();
}

document.getElementById("themeToggle").addEventListener("click", () => {
  darkMode = !darkMode;
  localStorage.setItem("theme", darkMode ? 'dark' : 'light');
  applyTheme();
});

/* ===== TASK CONTEXT ===== */
function loadTaskContext() {
  const kategorija = localStorage.getItem("kategorija") || "empty";
  const god        = localStorage.getItem("god") || "empty";
  const zadatak    = localStorage.getItem("zadatak") || "empty";
  const kolo       = localStorage.getItem("kolo") || "empty";

  let contextText = "";

  if(kategorija.toLowerCase() === "hll"){
    contextText = `HLL -> ${god} -> ${kolo} -> ${zadatak}`;
  } else if(kategorija.toLowerCase() === "hloz"){
    contextText = `HLOŽ -> ${god} -> ${zadatak}`;
  } else {
    contextText = `${kategorija} -> ${god} -> ${kolo} -> ${zadatak}`;
  }

  document.getElementById("taskContext").textContent = contextText;
}

/* ===== INIT ===== */
applyTranslations();
applyTheme();
loadTaskContext();
</script>

</body>
</html>
